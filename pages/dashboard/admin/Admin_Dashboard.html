<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>L3Z — Admin Dashboard</title>
<meta http-equiv="Cache-Control" content="no-store"/>
<style>
  :root{--bg:#060b0d;--ink:#eaf7ff;--muted:#a8c6cc;--line:rgba(0,255,255,.18);--teal:#00ffff;--warn:#ff9b6b}
  *{box-sizing:border-box}
  html,body{margin:0;height:100%;background:#041014 url("/assets/BG_page.png") center/cover fixed no-repeat;color:var(--ink);font-family:Segoe UI,system-ui,Arial,sans-serif}
  header{display:flex;gap:12px;align-items:center;justify-content:space-between;padding:14px 18px;background:rgba(0,0,0,.55);border-bottom:1px solid var(--line);position:sticky;top:0}
  h1{margin:0;font-size:18px;letter-spacing:.5px}
  .crumb{color:#9fd;opacity:.9}
  .back{border:1px solid var(--line);background:#08181c;color:#cfe;border-radius:10px;padding:8px 12px;text-decoration:none}
  .grid{max-width:1100px;margin:22px auto;padding:0 14px;display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px}
  .card{background:linear-gradient(180deg,#0b1519,#081116);border:1px solid var(--line);border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.35);padding:14px;display:flex;flex-direction:column;gap:10px;position:relative}
  .card img{width:56px;height:56px;object-fit:contain;filter:drop-shadow(0 4px 10px rgba(0,255,255,.15))}
  .card h3{margin:0;font-size:16px}
  .card p{margin:0;color:#a9c7cf;font-size:13px;min-height:34px}
  .card a{margin-top:auto;align-self:flex-start;text-decoration:none;border:1px solid var(--line);background:#0b2227;color:#cfe;padding:8px 10px;border-radius:10px;font-weight:700}
  .gate{max-width:900px;margin:28px auto;padding:20px;border:1px dashed #ffb5b5;background:rgba(255,0,0,.07);border-radius:14px;text-align:center}
  .gate h2{margin:0 0 8px;color:#ffb5b5}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:center;margin-top:10px}
  .pill{padding:6px 10px;border:1px solid var(--line);border-radius:999px;background:#081318;color:#cff;font-size:12px}
  .toolbar{max-width:1100px;margin:10px auto 0;padding:0 14px;display:flex;gap:10px;align-items:center}
  .btn{border:1px solid var(--line);background:#09171b;color:#bff;padding:8px 12px;border-radius:10px;text-decoration:none;font-weight:800}
</style>
</head>
<body>
  <header>
    <div class="crumb">L3Z — <strong>Admin Dashboard</strong></div>
    <a class="back" href="/index.html">← Back to site</a>
  </header>

  <main id="app">
    <!-- gate will be replaced when admin is verified -->
    <section id="gate" class="gate">
      <h2>Admin access required</h2>
      <p>You’re not signed in as an administrator. Use the normal login, then come back here.</p>
      <div class="row">
        <a class="btn" href="/pages/dashboard/home/login.html">Go to Login</a>
      </div>
    </section>
  </main>

<script>
(function(){
  "use strict";
  const app = document.getElementById("app");
  function api(path,opts){ opts=opts||{}; opts.credentials="include"; return fetch(path,opts); }

  // Build the dashboard UI (cards)
  function buildCards(){
    const cards = [
      { href:"/pages/dashboard/admin/bets_admin.html",            title:"Bets Admin (Unified)",  img:"/assets/lash3zbux_pp.png", desc:"Publish, edit and manage betting markets." },
      { href:"/pages/dashboard/admin/battleground_admin.html",    title:"Battleground Admin",     img:"/assets/lashes%20battleground.png", desc:"Create/seed brackets & matches." },
      { href:"/pages/dashboard/admin/battleground_widget.html",   title:"Battleground Widget",    img:"/assets/lashes%20battleground.png", desc:"On-stream widget for Battleground." },
      { href:"/pages/dashboard/admin/bonus_hunt_admin.html",      title:"Bonus Hunt Admin",       img:"/assets/bonus_hunt_icon.png", desc:"Configure Bonus Hunt runs and games." },
      { href:"/pages/dashboard/admin/bonus_hunt_widget.html",     title:"Bonus Hunt Widget",      img:"/assets/bonus_hunt_icon.png", desc:"Overlay widget for Bonus Hunts." },
      { href:"/pages/dashboard/admin/pvp_admin.html",             title:"PVP Admin",              img:"/assets/pvp_icon.png", desc:"Approve entries and manage PVP." },
      { href:"/pages/dashboard/admin/lucky7.html",                title:"Lucky 7",                img:"/assets/control_panel_icon.png", desc:"Tournament points & events." },
      { href:"/pages/dashboard/admin/admin_hub.html",             title:"Admin Hub",              img:"/assets/L3Z_logoMain.png", desc:"Tools & quick actions." },
    ];

    const toolbar = document.createElement("div");
    toolbar.className="toolbar";
    const who = document.createElement("span");
    who.className="pill"; who.id="who";
    toolbar.appendChild(who);
    const logout = document.createElement("a");
    logout.className="btn"; logout.textContent="Log out of admin";
    logout.href="#"; logout.addEventListener("click", async (e)=>{ e.preventDefault(); try{ await api("/api/admin/gate/logout",{method:"POST"}); location.reload(); }catch(_){ location.reload(); } });
    toolbar.appendChild(logout);

    const grid = document.createElement("section");
    grid.className="grid";
    cards.forEach(c=>{
      const card = document.createElement("article");
      card.className="card";
      const img = document.createElement("img"); img.src=c.img; img.alt=c.title;
      const h3 = document.createElement("h3"); h3.textContent=c.title;
      const p  = document.createElement("p");  p.textContent=c.desc;
      const a  = document.createElement("a");  a.href=c.href; a.textContent="Open";
      card.append(img,h3,p,a); grid.appendChild(card);
    });

    app.innerHTML="";
    app.appendChild(toolbar);
    app.appendChild(grid);
  }

  // Check admin status (send cookies!)
  (async function verify(){
    try{
      const r = await api("/api/admin/gate/check");
      if (!r.ok) throw 0;
      const j = await r.json();
      buildCards();
      const who = document.getElementById("who");
      if (who) who.textContent = "Signed in as admin: " + (j?.username || "unknown");
    }catch(_){
      // leave the gate visible
    }
  })();
})();
</script>
</body>
</html>
